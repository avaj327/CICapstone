<!DOCTYPE html>
<html>

<head>
	<title>Where to Next</title>
	<link rel="stylesheet" href="static/css/style.css">
	<!-- Links to retrieve the Quicksand font from google-->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Quicksand&display=swap" rel="stylesheet">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.js" integrity="sha512-DWtDo/6AXxH1t9p7GCWqmC4XTVK/eje94XTV6QYB39rGllLN8Tr3izDf6lkmebgqRnYh4wtSFm4CvBoA9SrdpA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<!---
	<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/addons/p5.sound.js" integrity="sha512-TU9AWtV5uUZPX8dbBAH8NQF1tSdigPRRT82vllAQ1Ke28puiqLA6ZVKxtUGlgrH6yWFnkKy+sE6luNEGH9ar0A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	-->
</head>

<body>
	<div id="sidebar_home">
		<h1><a id="home_button" href="/">Where To Next?</a></h1>
		<ul id="sidebar_list">

			<li>
				<h4 class="sidebar_city">Atlanta, Georgia</h4>
				<ul class="sidebar_dropdown">
					<li><a class="tab_selector" href="data?city=Atlanta#census">Census</a></li>
					<li><a class="tab_selector" href="data?city=Atlanta#weather">Weather</a></li>
					<li><a class="tab_selector" href="data?city=Atlanta#jobs">Jobs</a></li>
					<li><a class="tab_selector" href="data?city=Atlanta#stops">Stops</a></li>
				</ul>
				<br>
			</li>


			<li>
				<h4 class="sidebar_city">Billings, Montana</h4>
				<ul class="sidebar_dropdown">
					<li><a class="tab_selector" href="data?city=Billings#census">Census</a></li>
					<li><a class="tab_selector" href="data?city=Billings#weather">Weather</a></li>
					<li><a class="tab_selector" href="data?city=Billings#jobs">Jobs</a></li>
					<li><a class="tab_selector" href="data?city=Billings#stops">Stops</a></li>
				</ul>
				<br>
			</li>

			<li>
				<h4 class="sidebar_city">Detroit, Michigan</h4>
				<ul class="sidebar_dropdown">
					<li><a class="tab_selector" href="data?city=Detroit#census">Census</a></li>
					<li><a class="tab_selector" href="data?city=Detroit#weather">Weather</a></li>
					<li><a class="tab_selector" href="data?city=Detroit#jobs">Jobs</a></li>
					<li><a class="tab_selector" href="data?city=Detroit#stops">Stops</a></li>
				</ul>
				<br>
			</li>

			<li>
				<h4 class="sidebar_city">Houston, Texas</h4>
				<ul class="sidebar_dropdown">
					<li><a class="tab_selector" href="data?city=Houston#census">Census</a></li>
					<li><a class="tab_selector" href="data?city=Houston#weather">Weather</a></li>
					<li><a class="tab_selector" href="data?city=Houston#jobs">Jobs</a></li>
					<li><a class="tab_selector" href="data?city=Houston#stops">Stops</a></li>
				</ul>
				<br>
			</li>

			<li>
				<h4 class="sidebar_city">Los Angeles, California</h4>
				<ul class="sidebar_dropdown">
					<li><a class="tab_selector" href="data?city=Los Angeles#census">Census</a></li>
					<li><a class="tab_selector" href="data?city=Los Angeles#weather">Weather</a></li>
					<li><a class="tab_selector" href="data?city=Los Angeles#jobs">Jobs</a></li>
					<li><a class="tab_selector" href="data?city=Los Angeles#stops">Stops</a></li>
				</ul>
				<br>
			</li>

			<li>
				<h4 class="sidebar_city">Minneapolis, Minnesota</h4>
				<ul class="sidebar_dropdown">
					<li><a class="tab_selector" href="data?city=Minneapolis#census">Census</a></li>
					<li><a class="tab_selector" href="data?city=Minneapolis#weather">Weather</a></li>
					<li><a class="tab_selector" href="data?city=Minneapolis#jobs">Jobs</a></li>
					<li><a class="tab_selector" href="data?city=Minneapolis#stops">Stops</a></li>
				</ul>
				<br>
			</li>

			<li>
				<h4 class="sidebar_city">New York, New York</h4>
				<ul class="sidebar_dropdown">
					<li><a class="tab_selector" href="data?city=New York#census">Census</a></li>
					<li><a class="tab_selector" href="data?city=New York#weather">Weather</a></li>
					<li><a class="tab_selector" href="data?city=New York#jobs">Jobs</a></li>
					<li><a class="tab_selector" href="data?city=New York#stops">Stops</a></li>
				</ul>
				<br>
			</li>

			<li>
				<h4 class="sidebar_city">Philadelphia, Pennsylvania</h4>
				<ul class="sidebar_dropdown">
					<li><a class="tab_selector" href="data?city=Philadelphia#census">Census</a></li>
					<li><a class="tab_selector" href="data?city=Philadelphia#weather">Weather</a></li>
					<li><a class="tab_selector" href="data?city=Philadelphia#jobs">Jobs</a></li>
					<li><a class="tab_selector" href="data?city=Philadelphia#stops">Stops</a></li>
				</ul>
				<br>
			</li>

			<li>
				<h4 class="sidebar_city">Phoenix, Arizona</h4>
				<ul class="sidebar_dropdown">
					<li><a class="tab_selector" href="data?city=Phoenix#census">Census</a></li>
					<li><a class="tab_selector" href="data?city=Phoenix#weather">Weather</a></li>
					<li><a class="tab_selector" href="data?city=Phoenix#jobs">Jobs</a></li>
					<li><a class="tab_selector" href="data?city=Phoenix#stops">Stops</a></li>
				</ul>
				<br>
			</li>

			<li>
				<h4 class="sidebar_city">Portland, Oregon</h4>
				<ul class="sidebar_dropdown">
					<li><a class="tab_selector" href="data?city=Portland#census">Census</a></li>
					<li><a class="tab_selector" href="data?city=Portland#weather">Weather</a></li>
					<li><a class="tab_selector" href="data?city=Portland#jobs">Jobs</a></li>
					<li><a class="tab_selector" href="data?city=Portland#stops">Stops</a></li>
				</ul>
				<br>
			</li>

			<li>
				<h4 class="sidebar_city">Seattle, Washington</h4>
				<ul class="sidebar_dropdown">
					<li><a class="tab_selector" href="data?city=Seattle#census">Census</a></li>
					<li><a class="tab_selector" href="data?city=Seattle#weather">Weather</a></li>
					<li><a class="tab_selector" href="data?city=Seattle#jobs">Jobs</a></li>
					<li><a class="tab_selector" href="data?city=Seattle#stops">Stops</a></li>
				</ul>
				<br>
			</li>

			<li>
				<h4 class="sidebar_city">Washington, DC</h4>
				<ul class="sidebar_dropdown">
					<li><a class="tab_selector" href="data?city=Washington#census">Census</a></li>
					<li><a class="tab_selector" href="data?city=Washington#weather">Weather</a></li>
					<li><a class="tab_selector" href="data?city=Washington#jobs">Jobs</a></li>
					<li><a class="tab_selector" href="data?city=Washington#stops">Stops</a></li>
				</ul>
				<br>
			</li>
		</ul>
	</div>
	<div id="main_content" class="data_section">
		<!-- Home page data -->
		<p id="description">Where to next? What’s the best place to go for work or career advancement? This project’s
			goal is to help a prospective college graduate search for their ideal location in regards to a job, housing,
			transportation, and weather.</p>


		<p id="navigation_help">To navigate the site, hover over a city on the sidebar and select the data you wish to
			see.</p>



		<div id="team_member_div">
			<p id="reference">Flocking Simulation by: Daniel Shiffman: http://natureofcode.com</p>
			<h4 id="team_member_heading">Team members and contributions:</h4>
			<ul id="team_member_list">
				<li>
					<p class="team_member_name">Ava Johnson</p>
					<ul class="contributions_list">
						<li class="contribution">Job Availability - USAJOBS API</li>
						<li class="contribution">HTML/CSS/Frontend</li>
					</ul>

				</li>
				<li>
					<p class="team_member_name">Timothy Schroeder</p>
					<ul class="contributions_list">
						<li class="contribution">Transportation - Transitland V2 REST API</li>
					</ul>
				</li>
				<li>
					<p class="team_member_name">Brandon Susini</p>
					<ul class="contributions_list">
						<li class="contribution">Real Estate - Census API</li>
						<li class="contribution">Flask/Backend</li>
						<li class="contribution">CSS/Flocking/Frontend</li>
					</ul>
				</li>
				<li>
					<p class="team_member_name">Gennaro DiColandrea</p>
					<ul class="contributions_list">
						<li class="contribution">Weather - NCEI's Climate Data Online (CDO) API</li>
						<li class="contribution">HTML/CSS/Frontend</li>
					</ul>
				</li>

			</ul>
		</div>


	</div>
	
	<script id="flocking">  //Brandon
        let flock;
        let bg_color = "white";
		//let bg_color = "#f7cdd7";
        var cnv;
        var body_height = screen.height;
        var body_padding = 50;
        let boid_color = "#B590EE";
        let boid_border_color = "#79ab98";
		var USA;
		var music;
		function preload() {
  			USA = loadImage('http://173.3.218.130:5000/static/us_map.png');
			//music = loadSound("http://173.3.218.130:5000/static/star_spangled_trumpet.mp3",playSound);
		}
        function setup() {
            createCanvas(window.innerWidth, body_height).position(0, 0).style('z-index', "-999");
			
            //cnv = select('#middle_block').style("height", "" + my_height - height_diff + "px");
            flock = new Flock();
            // Add an initial set of boids into the system
            for (let i = 0; i < 70; i++) {
				let b1 = new Boid(100,100);
                let b2 = new Boid(width / 1.09, height / 2.40);
				flock.addBoid(b1);
                flock.addBoid(b2);
            }
            /*
            c1 = color("#252147");
            c2 = color("#c64156");

            for (let y = 0; y < height; y++) {
                n = map(y, 0, height, 0, 1);
                let newc = lerpColor(c1, c2, n);
                stroke(newc);
                line(0, y, width, y);
            }
            */
        }
		function mousePressed(){
			if(music.isPlaying()){
				music.stop();
			}else{
				music.play();
			}
		}
		function playSound(){
			//music.play();
		}
        function windowResized() {
            resizeCanvas(window.innerWidth, body_height);
            //cnv.style("height", "" + my_height - height_diff + "px");
        }

        function draw() {
            background(bg_color);
			image(USA,0,0,window.innerWidth,window.innerHeight);
			//text(flock.boids.length, width/2,height-100);
            flock.run();
        }

        /*
        // Add a new boid into the System
        function mouseDragged() {
            flock.addBoid(new Boid(mouseX, mouseY));
        }
        */
        // The Nature of Code
        // Daniel Shiffman
        // http://natureofcode.com

        // Flock object
        // Does very little, simply manages the array of all the boids

        function Flock() {
            // An array for all the boids
            this.boids = []; // Initialize the array
        }

        Flock.prototype.run = function () {
            for (let i = 0; i < this.boids.length; i++) {
                this.boids[i].run(this.boids);  // Passing the entire list of boids to each boid individually
            }
        }

        Flock.prototype.addBoid = function (b) {
            this.boids.push(b);
        }

        // The Nature of Code
        // Daniel Shiffman
        // http://natureofcode.com

        // Boid class
        // Methods for Separation, Cohesion, Alignment added
        function Boid(x, y) {
            this.acceleration = createVector(0, 0);
            this.velocity = createVector(random(-1, 1), random(-1, 1));
            this.position = createVector(x, y);
            this.r = 3.0;
            this.maxspeed = random(3,7);    // Maximum speed
            this.maxforce = 0.2;//0.05; // Maximum steering force
			this.random_modifier = random(10,50);
			this.color = color(181 +this.random_modifier,144 +this.random_modifier,238+this.random_modifier);
        }

        Boid.prototype.run = function (boids) {
            this.flock(boids);
            this.update();
            this.borders();
            this.render();
        }

        Boid.prototype.applyForce = function (force) {
            // We could add mass here if we want A = F / M
            this.acceleration.add(force);
        }

        // We accumulate a new acceleration each time based on three rules
        Boid.prototype.flock = function (boids) {
            let sep = this.separate(boids);   // Separation
            let ali = this.align(boids);      // Alignment
            let coh = this.cohesion(boids);   // Cohesion
            // Arbitrarily weight these forces
            sep.mult(1.5);
            ali.mult(1.0);
            coh.mult(1.0);
            // Add the force vectors to acceleration
            this.applyForce(sep);
            this.applyForce(ali);
            this.applyForce(coh);
        }

        // Method to update location
        Boid.prototype.update = function () {
            // Update velocity
            this.velocity.add(this.acceleration);
            // Limit speed
            this.velocity.limit(this.maxspeed);
            this.position.add(this.velocity);
            // Reset accelertion to 0 each cycle
            this.acceleration.mult(0);
        }

        // A method that calculates and applies a steering force towards a target
        // STEER = DESIRED MINUS VELOCITY
        Boid.prototype.seek = function (target) {
            let desired = p5.Vector.sub(target, this.position);  // A vector pointing from the location to the target
            // Normalize desired and scale to maximum speed
            desired.normalize();
            desired.mult(this.maxspeed);
            // Steering = Desired minus Velocity
            let steer = p5.Vector.sub(desired, this.velocity);
            steer.limit(this.maxforce);  // Limit to maximum steering force
            return steer;
        }

        Boid.prototype.render = function () {
            // Draw a triangle rotated in the direction of velocity
            let theta = this.velocity.heading() + radians(90);
            fill(this.color);
            stroke(boid_border_color);
            push();
            translate(this.position.x, this.position.y);
            rotate(theta);
            beginShape();
            vertex(0, -this.r * 2);
            vertex(-this.r, this.r * 2);
            vertex(this.r, this.r * 2);
            endShape(CLOSE);
            pop();
        }

        // Wraparound
        Boid.prototype.borders = function () {
            if (this.position.x < -this.r) this.position.x = width + this.r;
            if (this.position.y < -this.r) this.position.y = height + this.r;
            if (this.position.x > width + this.r) this.position.x = -this.r;
            if (this.position.y > height + this.r) this.position.y = -this.r;
        }

        // Separation
        // Method checks for nearby boids and steers away
        Boid.prototype.separate = function (boids) {
            let desiredseparation = 25.0;
            let steer = createVector(0, 0);
            let count = 0;
			let mousePos = createVector(mouseX,mouseY);
            // For every boid in the system, check if it's too close
            for (let i = 0; i < boids.length; i++) {
                let d = p5.Vector.dist(this.position, boids[i].position);
				
                // If the distance is greater than 0 and less than an arbitrary amount (0 when you are yourself)
                if ((d > 0) && (d < desiredseparation)) {
                    // Calculate vector pointing away from neighbor
                    let diff = p5.Vector.sub(this.position, boids[i].position);
                    diff.normalize();
                    diff.div(d);        // Weight by distance
                    steer.add(diff);
                    count++;            // Keep track of how many
                }
				
            }
			let d2 = p5.Vector.dist(this.position, mousePos);
			if ((d2 > 0) && (d2 < desiredseparation)) {
                    // Calculate vector pointing away from neighbor
                    let diff = p5.Vector.sub(this.position, mousePos);
                    diff.normalize();
                    diff.div(d2);        // Weight by distance
                    steer.add(diff);
                    count++;            // Keep track of how many
                }
            // Average -- divide by how many
            if (count > 0) {
                steer.div(count);
            }

            // As long as the vector is greater than 0
            if (steer.mag() > 0) {
                // Implement Reynolds: Steering = Desired - Velocity
                steer.normalize();
                steer.mult(this.maxspeed);
                steer.sub(this.velocity);
                steer.limit(this.maxforce);
            }
            return steer;
        }

        // Alignment
        // For every nearby boid in the system, calculate the average velocity
        Boid.prototype.align = function (boids) {
            let neighbordist = 50;
            let sum = createVector(0, 0);
            let count = 0;
            for (let i = 0; i < boids.length; i++) {
                let d = p5.Vector.dist(this.position, boids[i].position);
                if ((d > 0) && (d < neighbordist)) {
                    sum.add(boids[i].velocity);
                    count++;
                }
            }
            if (count > 0) {
                sum.div(count);
                sum.normalize();
                sum.mult(this.maxspeed);
                let steer = p5.Vector.sub(sum, this.velocity);
                steer.limit(this.maxforce);
                return steer;
            } else {
                return createVector(0, 0);
            }
        }

        // Cohesion
        // For the average location (i.e. center) of all nearby boids, calculate steering vector towards that location
        Boid.prototype.cohesion = function (boids) {
            let neighbordist = 50;
            let sum = createVector(0, 0);   // Start with empty vector to accumulate all locations
            let count = 0;
            for (let i = 0; i < boids.length; i++) {
                let d = p5.Vector.dist(this.position, boids[i].position);
                if ((d > 0) && (d < neighbordist)) {
                    sum.add(boids[i].position); // Add location
                    count++;
                }
            }
            if (count > 0) {
                sum.div(count);
                return this.seek(sum);  // Steer towards the location
            } else {
                return createVector(0, 0);
            }
        }



    </script>
	
</body>

</html>